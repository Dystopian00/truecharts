{{- if eq .Values.hostNetwork false }}
apiVersion: v1
kind: Service
metadata:
  name: {{ include "plex.fullname" . }}-tcp
  labels:
    {{- include "plex.labels" . | nindent 4 }}
{{- if .Values.serviceTCP.labels }}
{{ toYaml .Values.serviceTCP.labels | indent 4 }}
{{- end }}
{{- with .Values.serviceTCP.annotations }}
  annotations:
{{ toYaml . | indent 4 }}
{{- end }}
spec:
  type: NodePort
  ports:
    - name: pms
      port: {{ .Values.serviceTCP.port }}
      protocol: TCP
      targetPort: pms
      nodePort: {{.Values.serviceTCP.nodePort}}
    - name: http
      port: 80
      targetPort: pms
    - name: https
      port: 443
      targetPort: pms
    - name: plex-dlna
      port: 1900
      targetPort: plex-dlna
  selector:
    {{- include "plex.selectorLabels" . | nindent 4 }}
{{- end }}
