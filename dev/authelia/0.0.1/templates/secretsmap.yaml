apiVersion: v1
kind: ConfigMap
metadata:
  name: secretsmap
  labels:
  {{- include "common.labels" . | nindent 4 }}
data:
  AUTHELIA_JWT_SECRET_FILE: "/config/secrets/jwt"
  AUTHELIA_SESSION_SECRET_FILE: "/config/secrets/session"
  {{- if .Values.configMap.authentication_backend.ldap.enabled }}
  AUTHELIA_AUTHENTICATION_BACKEND_LDAP_PASSWORD_FILE: "/config/secrets/ldap"
  {{- end }}
  {{- if or (include "authelia.configured.smtp" .) (include "authelia.configured.smtpSecret" .) }}
  AUTHELIA_NOTIFIER_SMTP_PASSWORD_FILE: "/config/secrets/smtp"
  {{- end }}
  {{- if .Values.configMap.storage.postgres.enabled }}
  AUTHELIA_STORAGE_POSTGRES_PASSWORD_FILE: "/config/secrets/storage"
  {{- end }}
  {{- if and .Values.configMap.session.redis.enabled .Values.configMap.session.redis.enabledSecret }}
  AUTHELIA_SESSION_REDIS_PASSWORD_FILE: "/config/secrets/redis"
  {{- end }}
  {{- if and .Values.configMap.session.redis.high_availability.enabled .Values.configMap.session.redis.high_availability.enabledSecret }}
  AUTHELIA_SESSION_REDIS_HIGH_AVAILABILITY_SENTINEL_PASSWORD_FILE: "/config/secrets/redis-sentinel"
  {{- end }}
  {{- if and (include "authelia.configured.duo" .) (include "authelia.configured.duoSecret" .) }}
  AUTHELIA_DUO_API_SECRET_KEY_FILE: "/config/secrets/duo"
  {{- end }}
  {{- if .Values.configMap.identity_providers.oidc.enabled }}
  AUTHELIA_IDENTITY_PROVIDERS_OIDC_HMAC_SECRET_FILE: "/config/secrets/oidc-hmac-secret"
  AUTHELIA_IDENTITY_PROVIDERS_OIDC_ISSUER_PRIVATE_KEY_FILE: "/config/secrets/oidc-private-key"
  {{- end }}
