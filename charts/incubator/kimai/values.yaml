image:
  repository: tccr.io/truecharts/kimai
  tag: vapache-1.19@sha256:c397c8f343f90c7997cf524d9b05636571c017db8d9e6db3c6328abfe3cd3b81
  pullPolicy: IfNotPresent

securityContext:
  runAsNonRoot: false
  readOnlyRootFilesystem: false

podSecurityContext:
  runAsUser: 33
  runAsGroup: 33

secret:
  ADMINMAIL: "admin@mysecretdomain.com"
  ADMINPASS: "MvvTfjagiaqDprGNVA"

env:
  DB_TYPE: "mysql"
  DB_PORT: "3306"
  DB_USER: "{{ .Values.mariadb.mariadbDatabase }}"
  DB_BASE: "{{ .Values.mariadb.mariadbUsername }}"
  # User Defined
  TRUSTED_HOSTS: "localhost"

envValueFrom:
  DB_PASS:
    secretKeyRef:
      name: mariadbcreds
      key: mariadb-password
  DB_HOST:
    secretKeyRef:
      name: mariadbcreds
      key: plainhost

service:
  main:
    ports:
      main:
        port: 10198
        targetPort: 80

probes:
  liveness:
    enabled: true
    custom: true
    spec:
      exec:
        command:
        - bash
        - -c
        - curl --fail "http://localhost:80/en/login"

  readiness:
    enabled: true
    custom: true
    spec:
      exec:
        command:
        - bash
        - -c
        - curl --fail "http://localhost:80/en/login"

  startup:
    enabled: true
    custom: true
    spec:
      exec:
        command:
        - bash
        - -c
        - curl --fail "http://localhost:80/en/login"

persistence:
  # public:
  #   enabled: true
  #   type: emptyDir
  #   mountPath: "/opt/kimai/public"
  datai:
    enabled: true
    mountPath: "/opt/kimai/var"

mariadb:
  enabled: true
  mariadbUsername: kimai
  mariadbDatabase: kimai
  existingSecret: "mariadbcreds"

# additionalContainers:
#   nginx:
#     name: nginx
#     image: "{{ .Values.nginxImage.repository }}:{{ .Values.nginxImage.tag }}"
#     ports:
#       - containerPort: 80
#         name: main
#     volumeMounts:
#     - name: kimai-config
#       mountPath: "/etc/nginx/conf.d/default.conf"
#       subPath: nginx-config
#       readOnly: true
#     - name: public
#       mountPath: "/opt/kimai/public"
