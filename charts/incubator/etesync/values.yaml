image:
  repository: victorrds/etesync
  pullPolicy: IfNotPresent
  tag: 0.9.1@sha256:a880ed256dd78f14fb8dc9ab2e72ca2acebd3b8a87db65ea038f30abed27d896

podSecurityContext:
  runAsUser: 373
  runAsGroup: 373
  fsGroup: 373

etesync:
  ALLOWED_HOSTS: "*"
  AUTO_SIGNUP: false
  LANGUAGE_CODE: "en-us"
  SUPER_USER: "admin"
  SUPER_PASS: "TestPassword"
  SUPER_EMAIL: "admin@example.com"
  DEBUG: true
  SHELL_DEBUG: true
  DEBUG_DJANGO: true

# Docker image configuration docs:
# https://github.com/victor-rds/docker-etebase#settings-and-customization

# EteSync configuration docs:
# https://github.com/etesync/server#configuration

env:
  # App
  SERVER: http
  AUTO_UPDATE: true
  ALLOWED_HOSTS: "{{ .Values.etesync.ALLOWED_HOSTS }}"
  AUTO_SIGNUP: "{{ .Values.etesync.AUTO_SIGNUP }}"
  LANGUAGE_CODE: "{{ .Values.etesync.LANGUAGE_CODE }}"
  TIME_ZONE: "{{ .Values.TZ }}"

  # Superuser
  SUPER_USER:
    secretKeyRef:
      name: etesync-secret
      key: SUPER_USER
  SUPER_PASS:
    secretKeyRef:
      name: etesync-secret
      key: SUPER_PASS
  SUPER_EMAIL:
    secretKeyRef:
      name: etesync-secret
      key: SUPER_EMAIL

  # Debugging
  DEBUG: "{{ .Values.etesync.DEBUG }}"
  SHELL_DEBUG: "{{ .Values.etesync.SHELL_DEBUG }}"
  DEBUG_DJANGO: "{{ .Values.etesync.DEBUG_DJANGO }}"

  # Postgres
  DB_ENGINE: postgres
  DATABASE_NAME: "{{ .Values.postgresql.postgresqlDatabase }}"
  DATABASE_USER: "{{ .Values.postgresql.postgresqlUsername }}"
  DATABASE_PASSWORD:
    secretKeyRef:
      name: dbcreds
      key: postgresql-password
  DATABASE_HOST:
    secretKeyRef:
      name: dbcreds
      key: plainhost
  DATABASE_PORT: 5432

service:
  main:
    protocol: HTTP
    ports:
      main:
        targetPort: 3735
        port: 10254

persistence:
  app:
    enabled: true
    mountPath: "/data"
  secret:
    enabled: true
    type: "custom"
    readOnly: true
    mountPath: "/data/secret.txt"
    subPath: "secret.txt"
    volumeSpec:
      secret:
        secretName: "etesync-secret"

probes:
  liveness:
    path: "/"
  readiness:
    path: "/"
  startup:
    path: "/"

postgresql:
  enabled: true
  existingSecret: "dbcreds"
  postgresqlUsername: etesync
  postgresqlDatabase: etesync
