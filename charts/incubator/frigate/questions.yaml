# Include{groups}
portals:
  open:
# Include{portalLink}
questions:
# Include{global}
# Include{controller}
# Include{replicas}
# Include{replica1}
# Include{controllerExpertExtraArgs}
  - variable: frigate
    group: App Configuration
    label: Frigate Configuration
    schema:
      additional_attrs: true
      type: dict
      attrs:
        - variable: mqtt
          label: MQTT
          schema:
            additional_attrs: true
            type: dict
            attrs:
              - variable: host
                label: Host
                schema:
                  type: string
                  required: true
                  default: ""
              - variable: port
                label: Port
                schema:
                  type: int
                  required: true
                  default: 1883
              - variable: topic_prefix
                label: Topic Prefix
                description: Must be unique if you are running multiple instances
                schema:
                  type: string
                  required: true
                  default: frigate
              - variable: topic_prefix
                label: Client ID
                description: Must be unique if you are running multiple instances
                schema:
                  type: string
                  required: true
                  default: frigate
              - variable: stats_interval
                label: Stats Interval
                description: Interval in seconds for publishing stats
                schema:
                  type: int
                  required: true
                  default: 60
              - variable: user
                label: Username
                schema:
                  type: string
                  default: ""
              - variable: password
                label: Password
                schema:
                  type: string
                  private: true
                  default: ""
        - variable: detectors
          label: Detectors
          schema:
            additional_attrs: true
            type: dict
            attrs:
              - variable: enabled
                label: Enabled
                schema:
                  type: boolean
                  default: false
                  show_subquestions_if: true
                  subquestions:
                    - variable: config
                      label: Detectors Configuration
                      type: list
                      default: []
                      items:
                        - variable: name
                          label: Name
                          description: Name of the detector
                          schema:
                            type: string
                            required: true
                            default: ""
                        - variable: type
                          label: Type
                          description: Name of the detector
                          schema:
                            type: string
                            required: true
                            default: cpu
                            enum:
                              - value: cpu
                                description: CPU
                              - value: edgetpu
                                description: Edge TPU
                        - variable: device
                          label: Device
                          description: Device name as defined here - https://coral.ai/docs/edgetpu/multiple-edgetpu/#using-the-tensorflow-lite-python-api
                          schema:
                            type: string
                            default: ""
                        - variable: num_threads
                          label: Number of Threads
                          description: This value is only used for CPU types
                          schema:
                            type: int
                            show_if: [["type", "=", "cpu"]]
                            default: 3





        - variable: enable_models
          label: Enable Model Configuration
          schema:
            type: boolean
            default: false
            show_subquestions_if: true
            subquestions:
              - variable: model
                label: Model
                schema:
                  additional_attrs: true
                  type: dict
                  attrs:
                    - variable: path
                      label: Path
                      description: Path to the model
                      schema:
                        type: string
                        default: ""
                    - variable: labelmap_path
                      label: Label Map Path
                      description: Path to the labelmap
                      schema:
                        type: string
                        default: ""
                    - variable: width
                      label: Width
                      description: Object detection model input width
                      schema:
                        type: int
                        required: true
                        default: 320
                    - variable: height
                      label: Height
                      description: Object detection model input height
                      schema:
                        type: int
                        required: true
                        default: 320
        - variable: enable_logger
          label: Enable Logger Configuration
          schema:
            type: boolean
            default: false
            show_subquestions_if: true
            subquestions:
              - variable: logger
                label: Logger
                schema:
                  additional_attrs: true
                  type: dict
                  attrs:
                    - variable: default
                      label: default
                      description: Default log verbosity
                      schema:
                        type: string
                        required: true
                        default: info
                    # - variable: logs
                    #   label: logs
                    #   description: Component specific logger overrides
                    #   schema:
                    #     additional_attrs:
                    #     type: dict
                    #     attrs:
        - variable: birdseye
          label: Birds Eye
          schema:
            additional_attrs: true
            type: dict
            attrs:
              - variable: enabled
                label: Enabled
                description: Enable birdseye view
                schema:
                  type: boolean
                  default: true
              - variable: width
                label: Width
                description: Width of the output resolution
                schema:
                  type: int
                  required: true
                  default: 1280
              - variable: height
                label: Height
                description: Height of the output resolution
                schema:
                  type: int
                  required: true
                  default: 720
              - variable: quality
                label: Quality
                description: Encoding quality of the mpeg1 feed. Where 1 is the highest quality, and 31 is the lowest. Lower quality feeds utilize less CPU resources.
                schema:
                  type: int
                  min: 1
                  max: 31
                  required: true
                  default: 8
              - variable: mode
                label: Mode
                description: |
                  Mode of the view.
                  objects - Cameras are included if they have had a tracked object within the last 30 seconds
                  motion - Cameras are included if motion was detected in the last 30 seconds
                  continuous - All cameras are included always
                schema:
                  type: string
                  required: true
                  default: objects
                  enum:
                    - value: objects
                      description: objects
                    - value: motion
                      description: motion
                    - value: continuous
                      description: continuous
        - variable: enable_ffmpeg
          label: Enable ffmpeg Configuration
          schema:
            type: boolean
            default: false
            show_subquestions_if: true
            subquestions:
              - variable: ffmpeg
                label: ffmpeg
                schema:
                  additional_attrs: true
                  type: dict
                  attrs:
                    - variable: global_args
                      label: Global Args
                      schema:
                        type: string
                        required: true
                        default: -hide_banner -loglevel warning
                    - variable: input_args
                      label: Input Args
                      schema:
                        type: string
                        required: true
                        default: -avoid_negative_ts make_zero -fflags +genpts+discardcorrupt -rtsp_transport tcp -timeout 5000000 -use_wallclock_as_timestamps 1
                    - variable: hwaccel_args
                      label: HW Acceleration Args
                      description: See hardware acceleration docs for your specific device
                      schema:
                        type: list
                        default: []
                        items:
                          - variable: hw_accel_arg
                            label: HW Acceleration Arg
                            schema:
                              type: string
                              required: true
                              default: ""
                    - variable: output_args
                      label: Output Args
                      schema:
                        additional_attrs: true
                        type: dict
                        attrs:
                          - variable: detect
                            label: Detect
                            schema:
                              type: string
                              required: true
                              default: -f rawvideo -pix_fmt yuv420p
                          - variable: record
                            label: Record
                            schema:
                              type: string
                              required: true
                              default: -f segment -segment_time 10 -segment_format mp4 -reset_timestamps 1 -strftime 1 -c copy -an
                          - variable: rtmp
                            label: RTMP
                            schema:
                              type: string
                              required: true
                              default: -c copy -f flv
        - variable: detect
          label: Detect
          schema:
            additional_attrs: true
            type: dict
            attrs:
              - variable: enabled
                label: Enabled
                description: Enables detection for the cameras
                schema:
                  type: boolean
                  default: true
              - variable: width
                label: Width
                description: Width of the frame for the input with the detect role
                schema:
                  type: int
                  required: true
                  default: 1280
              - variable: height
                label: Height
                description: Height of the frame for the input with the detect role
                schema:
                  type: int
                  required: true
                  default: 720
              - variable: fps
                label: FPS
                description: Desired fps for your camera for the input with the detect role. Recommended value of 5. Ideally, try and reduce your FPS on the camera.
                schema:
                  type: int
                  required: true
                  default: 5
              - variable: max_disappeared
                label: Max Disappeared
                description: Number of frames without a detection before frigate considers an object to be gone.
                schema:
                  type: int
                  required: true
                  default: 25
              - variable: stationary
                label: Stationary
                schema:
                  additional_attrs: true
                  type: dict
                  attrs:
                    - variable: interval
                      label: Interval
                      description: |
                        Frequency for confirming stationary objects
                        When set to 0, object detection will not confirm stationary objects until movement is detected.
                        If set to 10, object detection will run to confirm the object still exists on every 10th frame.
                      schema:
                        type: int
                        required: true
                        default: 0
                    - variable: threshold
                      label: Threshold
                      description: Number of frames without a position change for an object to be considered stationary
                      schema:
                        type: int
                        required: true
                        default: 50
                    - variable: max_frames
                      label: Max Frames
                      schema:
                        additional_attrs: true
                        type: dict
                        attrs:
                          - variable: default
                            label: Default
                            description: Default for all object types
                            schema:
                              type: int
                              required: true
                              default: 3000
                          - variable: objects
                            label: Objects
                            schema:
                              additional_attrs: true
                              type: dict
                              attrs:
                                - variable: person
                                  label: Person
                                  description: Default for all object types
                                  schema:
                                    type: int
                                    required: true
                                    default: 1000

  - variable: additional_frigate
    group: App Configuration
    label: Additional Frigate Configuration
    schema:
      type: list
      default: []
      items:
        - variable: entry
          label: Key - Value Pair
          schema:
            additional_attrs: true
            type: dict
            attrs:
              - variable: key
                label: Key
                schema:
                  type: string
                  required: true
                  default: ""
              - variable: value
                label: Value
                schema:
                  type: string
                  required: true
                  default: ""
# Include{containerConfig}
# Include{serviceRoot}
        - variable: main
          label: Main Service
          description: The Primary service on which the healthcheck runs, often the webUI
          schema:
            additional_attrs: true
            type: dict
            attrs:
# Include{serviceSelectorLoadBalancer}
# Include{serviceSelectorExtras}
                    - variable: main
                      label: Main Service Port Configuration
                      schema:
                        additional_attrs: true
                        type: dict
                        attrs:
                          - variable: port
                            label: Port
                            description: This port exposes the container port on the service
                            schema:
                              type: int
                              default: 5000
                              editable: true
                              required: true
        - variable: rtmp
          label: RTMP Service
          description: The service on which nodes connect to.
          schema:
            additional_attrs: true
            type: dict
            attrs:
# Include{serviceSelectorLoadBalancer}
# Include{serviceSelectorExtras}
                    - variable: rtmp
                      label: RTMP Service Port Configuration
                      schema:
                        additional_attrs: true
                        type: dict
                        attrs:
                          - variable: port
                            label: Port
                            description: This port exposes the container port on the service
                            schema:
                              type: int
                              default: 1935
                              editable: true
                              required: true
# Include{serviceExpertRoot}
            default: false
# Include{serviceExpert}
# Include{serviceList}
# Include{persistenceRoot}
        - variable: media
          label: App Media
          description: Stores the Application Media
          schema:
            additional_attrs: true
            type: dict
            attrs:
# Include{persistenceBasic}
        - variable: db
          label: App DB
          description: Stores the Application DB
          schema:
            additional_attrs: true
            type: dict
            attrs:
# Include{persistenceBasic}
# Include{persistenceList}
# Include{ingressRoot}
        - variable: main
          label: Main Ingress
          schema:
            additional_attrs: true
            type: dict
            attrs:
# Include{ingressDefault}
# Include{ingressTLS}
# Include{ingressTraefik}
# Include{ingressList}
# Include{security}
# Include{securityContextAdvancedRoot}
              - variable: privileged
                label: Privileged mode
                schema:
                  type: boolean
                  default: false
              - variable: readOnlyRootFilesystem
                label: ReadOnly Root Filesystem
                schema:
                  type: boolean
                  default: false
              - variable: allowPrivilegeEscalation
                label: Allow Privilege Escalation
                schema:
                  type: boolean
                  default: false
              - variable: runAsNonRoot
                label: runAsNonRoot
                schema:
                  type: boolean
                  default: false
# Include{podSecurityContextRoot}
        - variable: runAsUser
          label: runAsUser
          description: The UserID of the user running the application
          schema:
            type: int
            default: 0
        - variable: runAsGroup
          label: runAsGroup
          description: The groupID this App of the user running the application
          schema:
            type: int
            default: 0
        - variable: fsGroup
          label: fsGroup
          description: The group that should own ALL storage.
          schema:
            type: int
            default: 568
# Include{podSecurityContextAdvanced}
# Include{resources}
# Include{advanced}
# Include{addons}
# Include{codeserver}
# Include{vpn}
# Include{documentation}
