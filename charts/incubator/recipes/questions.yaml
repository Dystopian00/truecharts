# Include{groups}
portals:
  open:
# Include{portalLink}
questions:
# Include{global}
# Include{workload}
# Include{workloadDeployment}
# Include{replicas1}
# Include{podSpec}
# Include{containerMain}
# Include{containerBasic}
# Include{containerAdvanced}
# Include{containerConfig}

  - variable: recipes
    group: App Configuration
    label: Recipes Configuration
    schema:
      additional_attrs: true
      type: dict
      attrs:
        - variable: debug
          label: Debug
          description: Set this to true when testing/debugging.
          schema:
            type: boolean
            default: false
        - variable: allowed_hosts
          label: Allowed Hosts
          description: Hosts the application can run under (e.g. recipes.mydomain.com,cooking.mydomain.com)
          schema:
            type: list
            empty: false
            default:
              - "*"
            required: true
            items:
              - variable: host
                label: Host
                schema:
                  type: string
                  required: true
                  default: ""
        - variable: csrf_trusted_orgins
          label: CSRF Trusted Origins
          description: A list of hosts which are trusted origins for unsafe requests.
          schema:
            type: list
            default: []
            items:
              - variable: host
                label: Host
                schema:
                  type: string
                  required: true
                  default: ""
        - variable: gunicorn_media
          label: Gunicorn Media
          description: Serve mediafiles directly using gunicorn.
          schema:
            type: boolean
            default: false
            show_subquestions_if: true
            subquestions:
              - variable: gunicorn_workers
                label: Gunicorn Workers
                schema:
                  type: int
                  default: 1
              - variable: gunicorn_threads
                label: Gunicorn Threads
                schema:
                  type: int
                  default: 1
        - variable: fraction_pref_default
          label: Fraction Pref Default
          description: Enable/Disable fraction support
          schema:
            type: boolean
            default: false
        - variable: comment_pref_default
            label: Comment Pref Default
            description: Enable/Disable commenting system
            schema:
              type: boolean
              default: true
        - variable: shopping_min_autosync_interval
          label: Shopping Min AutoSync Interval
          description: Set time which the shopping list is refreshed when in viewing mode.
          schema:
            type: int
            default: 5
            min: 5
        - variable: email
          label: Show Advanced Email Settings
          schema:
            type: boolean
            default: false
            show_subquestions_if: true
            subquestions:
              - variable: email_host
                label: Email Host
                schema:
                  type: string
                  default: ""
              - variable: email_port
                label: Email Port
                schema:
                  type: int
                  default: 587
              - variable: email_host_user
                label: Email Host User
                schema:
                  type: string
                  default: ""
              - variable: email_host_password
                label: Email Host Password
                schema:
                  type: string
                  private: true
                  default: ""
              - variable: email_use_tls
                label: Email Use TLS
                schema:
                  type: boolean
                  default: false
              - variable: email_use_ssl
                label: Email Use SSL
                schema:
                  type: boolean
                  default: false
              - variable: default_from_email
                label: Default From Email
                schema:
                  type: string
                  default: ""
              - variable: account_email_subject_prefix
                label: Account Email Subject Prefix
                schema:
                  type: string
                  default: "[Tandoor Recipes] "
        - variable: reverse_proxy_auth
            label: Reverse Proxy Auth
            description: Allow authentication via reverse proxy.
            schema:
              type: boolean
              default: false
        - variable: spaces
          label: Show Advanced Spaced Settings
          schema:
            type: boolean
            default: false
            show_subquestions_if: true
            subquestions:
              - variable: space_default_max_recipes
                label: Space Default Max Recipes
                description: Set limit of max recipes, 0=unlimited recipes.
                schema:
                  type: int
                  default: 0
              - variable: space_default_max_users
                label: Space Default Max Users
                description: Set limit of max users, 0=unlimited users per space.
                schema:
                  type: int
                  default: 0
              - variable: space_default_max_files
                label: Space Default Max Files
                description: Maximum file storage for space in MB, 0 for unlimited, -1 to disable file upload.
                schema:
                  type: int
                  default: 0
              - variable: space_default_allow_sharing
                label: Space Default Allow Sharing
                description: Allow users to share recipes with public links
                schema:
                  type: boolean
                  default: false
        - variable: enable_signup
          label: Enable SignUp
          description: Allow people to create accounts on your application instance (without an invite link).
          schema:
            type: boolean
            default: true
            show_subquestions_if: true
            subquestions:
              - variable: hcaptcha_sitekey
                label: Hcaptcha SiteKey (optional)
                schema:
                  type: string
                  private: true
                  default: ""
              - variable: hcaptcha_secret
                label: Hcaptcha Secret (optional)
                schema:
                  type: string
                  private: true
                  default: ""
              - variable: terms_url
                label: Terms Url (optional)
                schema:
                  type: string
                  default: ""
              - variable: privacy_url
                label: Privacy Url (optional)
                schema:
                  type: string
                  default: ""
              - variable: imprint_url
                label: Imprint Url (optional)
                schema:
                  type: string
                  default: ""
        - variable: ldap_auth
          label: Enable LDAP Auth
          description: list of allowed users will be fetched from LDAP server.
          schema:
            type: boolean
            default: false
            show_subquestions_if: true
            subquestions:
              - variable: auth_ldap_server_uri
                label: Auth LDAP Server Uri
                schema:
                  type: string
                  default: ""
              - variable: auth_ldap_bind_dn
                label: Auth LDAP Bind DN
                schema:
                  type: string
                  default: ""
              - variable: auth_ldap_bind_password
                label: Auth LDAP Bind Password
                schema:
                  type: string
                  private: true
                  default: ""
              - variable: auth_ldap_user_search_base_dn
                label: Auth LDAP User Search Base DN
                schema:
                  type: string
                  default: ""
        - variable: enable_pdf_export
            label: Enable PDF Export
            description: Enables exporting PDF (see export docs)
            schema:
              type: boolean
              default: false
        - variable: export_file_cache_duration
            label: Export File Cache Duration
            description: Recipe exports are cached for a certain time by default
            schema:
              type: int
              default: 600

# Include{podOptions}
# Include{serviceRoot}
        - variable: main
          label: "Main Service"
          description: "The Primary service on which the healthcheck runs, often the webUI"
          schema:
            additional_attrs: true
            type: dict
            attrs:
# Include{serviceSelectorLoadBalancer}
# Include{serviceSelectorExtras}
                    - variable: main
                      label: "Main Service Port Configuration"
                      schema:
                        additional_attrs: true
                        type: dict
                        attrs:
                          - variable: port
                            label: "Port"
                            description: "This port exposes the container port on the service"
                            schema:
                              type: int
                              default: 10029
                              required: true
# Include{serviceExpertRoot}
# Include{serviceExpert}
# Include{serviceList}
# Include{persistenceRoot}
        - variable: media
          label: "App Media Storage"
          description: "Stores the Application Media."
          schema:
            additional_attrs: true
            type: dict
            attrs:
# Include{persistenceBasic}
# Include{persistenceList}
# Include{ingressRoot}
        - variable: main
          label: "Main Ingress"
          schema:
            additional_attrs: true
            type: dict
            attrs:
# Include{ingressDefault}
# Include{ingressTLS}
# Include{ingressTraefik}
# Include{ingressAdvanced}
# Include{ingressList}
# Include{securityContextRoot}

              - variable: runAsUser
                label: "runAsUser"
                description: "The UserID of the user running the application"
                schema:
                  type: int
                  default: 0
              - variable: runAsGroup
                label: "runAsGroup"
                description: "The groupID of the user running the application"
                schema:
                  type: int
                  default: 0
# Include{securityContextContainer}
# Include{securityContextAdvanced}
# Include{securityContextPod}
              - variable: fsGroup
                label: "fsGroup"
                description: "The group that should own ALL storage."
                schema:
                  type: int
                  default: 568

# Include{resources}
# Include{advanced}
# Include{addons}
# Include{codeserver}
# Include{netshoot}
# Include{vpn}
# Include{documentation}
