image:
  repository: tccr.io/truecharts/vikunja-api
  tag: 0.20.1@sha256:839d6f23b3aa413e10bd252539a04866ad9b7fff3f1a6e2dac894c2674687709
  pullPolicy: IfNotPresent

frontendImage:
  repository: tccr.io/truecharts/vikunja-frontend
  tag: 0.20.2@sha256:556a26579911eb172ce23c903f7484040753e009b51144270eb208445d51edb0
  pullPolicy: IfNotPresent

nginxImage:
  repository: tccr.io/truecharts/nginx
  tag: 1.23.3@sha256:218715557a16838206fc2c924fb2ce39b76f81e46e5c62379f2c6e7a8d1e221d

securityContext:
  readOnlyRootFilesystem: false
  runAsNonRoot: false

podSecurityContext:
  runAsUser: 0
  runAsGroup: 0

configmap:
  nginx-config:
    enabled: true
    data:
      nginx-config: |
        server {
          listen {{ .Values.service.main.ports.main.port }};
          location / {
              proxy_pass http://localhost:80;
          }
          location ~* ^/(api|dav|\.well-known)/ {
              proxy_pass http://localhost:3456;
              client_max_body_size {{ .Values.vikunja.files.maxsize | upper | trimSuffix "B" }};
          }
        }

vikunja:
  service:
    jwtttl: 259200
    jwtttllong: 2592000
    motd: Welcome to your new Vikunja instance
    frontendurl: http://localhost:10220
    maxitemsperpage: 50
    enablecaldav: true
    enablelinksharing: true
    enableregistration: true
    enabletaskattachments: true
    enabletaskcomments: true
    enabletotp: true
    enableemailreminders: true
    enableuserdeletion: true
    maxavatarsize: 1024
  cors:
    enabled: true
    origins: []
    maxage: 0
  ratelimit:
    enabled: false
    kind: user
    period: 60
    limit: 100
  files:
    maxsize: 20MB
  avatar:
    gravatarexpiration: 3600
  legal:
    imprinturl: ""
    privacyurl: ""
  mailer:
    enabled: false
    host: ""
    port: 587
    authtype: plain
    username: ""
    password: ""
    skiptlsverify: false
    fromemail: ""
    queuelength: 100
    queuetimeout: 30
    forcessl: true
  log:
    enabled: true
    standard: stdout
    level: INFO
    database: false
    databaselevel: WARNING
    http: stdout
    echo: false
    events: stdout
    eventslevel: info

  metrics:
    enabled: false
    username: ""
    password: ""
  defaultsettings:
    avatar_provider: initials
    avatar_file_id: 0
    email_reminders_enabled: false
    discoverable_by_name: false
    discoverable_by_email: false
    overdue_tasks_reminders_enabled: true
    overdue_tasks_reminders_time: "9:00"
    default_list_id: 0
    week_start: 0
    language: ""
    timezone: ""
  backgrounds:
    enabled: true
    providers:
      upload:
        enabled: true
      unsplash:
        enabled: false
        accesstoken: ""
        applicationid: ""
  migration:
    todoist:
      enable: false
      clientid: ""
      clientsecret: ""
      redirecturl: ""
    trello:
      enable: false
      key: ""
      redirecturl: ""
    microsofttodo:
      enable: false
      clientid: ""
      clientsecret: ""
      redirecturl: ""
  auth:
    local:
      enabled: true
    openid:
      enabled: false
      redirecturl: ""
      providers:
        []
        # - name: ""
        #   authurl: ""
        #   logouturl: ""
        #   clientid: ""
        #   clientsecret: ""

service:
  main:
    ports:
      main:
        port: 10220

additionalContainers:
  frontend:
    name: frontend
    image: "{{ .Values.frontendImage.repository }}:{{ .Values.frontendImage.tag }}"
  proxy:
    name: proxy
    image: "{{ .Values.nginxImage.repository }}:{{ .Values.nginxImage.tag }}"
    ports:
      - containerPort: 8080
        name: main
    volumeMounts:
      - name: vikunja-nginx
        mountPath: /etc/nginx/conf.d/default.conf
        subPath: nginx-config
        readOnly: true

persistence:
  files:
    enabled: true
    mountPath: /app/vikunja/files
  vikunja-nginx:
    enabled: true
    noMount: true
    mountPath: /etc/nginx/conf.d/default.conf
    subPath: nginx-config
    type: configMap
    objectName: '{{ template "tc.common.names.fullname" . }}-nginx-config'
  vikunja-config:
    enabled: true
    mountPath: /etc/vikunja
    subPath: config.yml
    type: secret
    objectName: '{{ template "tc.common.names.fullname" . }}-secret'

postgresql:
  enabled: true
  existingSecret: dbcreds
  postgresqlUsername: vikunja
  postgresqlDatabase: vikunja

redis:
  enabled: true
  existingSecret: rediscreds

portal:
  enabled: true
