env:
  ENABLE_BEPINEX: 'false'
  GAME_ID: '294420'
  GAME_PARAMS: -logfile 7DaysToDie_Data/output_log.txt $@
  PASSWRD: ''
  SERVERCONFIG: serverconfig.xml
  USERNAME: ''
  VALIDATE: ''
image:
  pullPolicy: IfNotPresent
  repository: ich777/steamcmd
  tag: 7dtd
persistence:
  serverfiles:
    enabled: true
    mountPath: /serverdata/serverfiles
  steamcmd:
    enabled: true
    mountPath: /serverdata/steamcmd
  configmap:
    enabled: true
    type: configMap
    # -- Specify the name of the configmap object to be mounted
    objectName: '{{printf "%v-override" ( include "common.names.fullname" . )}}'
    # -- Where to mount the volume in the main container.
    # Defaults to `/<name_of_the_volume>`,
    # setting to '-' creates the volume but disables the volumeMount.
    mountPath: /user.sh
    subPath: "user.sh"
podSecurityContext:
  runAsUser: 0
securityContext:
  readOnlyRootFilesystem: false
  runAsNonRoot: false
service:
  main:
    enabled: true
    ports:
      main:
        enabled: true
        port: 26900
        protocol: TCP
        targetPort: 26900
  raknet:
    enabled: true
    ports:
      raknet:
        enabled: true
        port: 26902
        protocol: UDP
        targetPort: 26902
  registeringats:
    enabled: true
    ports:
      registeringats:
        enabled: true
        port: 27015
        protocol: UDP
        targetPort: 27015
  steamcommunica:
    enabled: true
    ports:
      steamcommunica:
        enabled: true
        port: 26901
        protocol: UDP
        targetPort: 26901
  steammasterser:
    enabled: true
    ports:
      steammasterser:
        enabled: true
        port: 26900
        protocol: UDP
        targetPort: 26900
  unet:
    enabled: true
    ports:
      unet:
        enabled: true
        port: 26903
        protocol: UDP
        targetPort: 26903
  webbasecontrol:
    enabled: true
    ports:
      webbasecontrol:
        enabled: true
        port: 8080
        protocol: TCP
        targetPort: 8080
  webpanel:
    enabled: true
    ports:
      webpanel:
        enabled: true
        port: 8082
        protocol: TCP
        targetPort: 8082

command:
  - "/bin/bash"
  - "-c"
  - "groupadd -g ${GID} ${GROUP} && /opt/scripts/start.sh"
configmap:
  override:
    enabled: true
    data:
      user.sh: |
        #!/bin/bash
        #GROUP="steam"
        #groupadd -g ${GID} ${GROUP}
        #groupmod -g ${GID} ${GROUP}
        #useradd -u ${UID} -d ${DATA_DIR} -s /bin/bash ${USER}
        #usermod -u ${UID} ${USER}
        #usermod -g ${GID} ${USER}
        #for f in /opt/scripts/*
        #do
        #  if "${f}" != "/opt/scripts/user.sh"
        #    echo "Processing: ${f}"
        #    chown -Rf ${UID}:${GID} ${f}
        #    chmod -Rf 755 ${f}
        #  fi
        #done
        #chown -Rf ${UID}:${GID} ${DATA_DIR}
        #ls -l /opt/scripts
        #sudo -u steam id
